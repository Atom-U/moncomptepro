<div class="card-container">
    <%- include('../partials/notifications.ejs', {notifications: notifications, noWrapperDiv: true}) %>
    <div class="fr-card">
        <div class="fr-card__body">
            <div class="fr-card__content">
                <h1 class="fr-card__title">
                    Changer votre mot de passe
                </h1>
                <div class="fr-card__desc">
                    <form action="/users/change-password" method="post">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>" autocomplete="off">

                        <input type="hidden" name="reset_password_token" value="<%= resetPasswordToken %>" />

                        <div class="fr-input-group fr-password js-password-container">
                            <label class="fr-label" for="password-input">
                                Nouveau mot de passe
                            </label>
                            <div class="fr-input-wrap">
                                <input
                                        class="fr-password__input fr-input js-password-container__input"
                                        aria-describedby="password-input-messages"
                                        aria-required="true"
                                        name="password"
                                        autocomplete="new-password"
                                        id="password-input"
                                        type="password"
                                        required
                                        minlength="10"
                                >
                            </div>
                            <div class="fr-messages-group" id="password-input-messages" aria-live="assertive">
                                <p class="fr-message" id="password-input-message">
                                    Votre mot de passe doit contenir :
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-10char">
                                    10 caractères minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-special">
                                    1 caractère spécial minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-number">
                                    1 chiffre minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-lowercase">
                                    1 lettre minuscule minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-uppercase">
                                    1 lettre majuscule minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-128char">
                                    128 caractères maximum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-3same">
                                    2 caractères identiques successifs maximum
                                </p>
                                <p class="fr-message" id="passphrase-input-message">
                                    Alternativement, votre mot de passe peut être une <i>phrase secrête</i>
                                    (<a
                                            target="_blank" rel="noopener noreferrer"
                                            href="/help#choisir-mot-de-passe">en savoir plus</a>)
                                    et doit contenir :
                                </p>
                                <p class="fr-message fr-message--info" id="passphrase-input-message-20char">
                                    20 caractères minimum
                                </p>
                                <p class="fr-message fr-message--info" id="password-input-message-blacklisted-word">
                                </p>
                            </div>
                            <div class="fr-password__checkbox fr-checkbox-group fr-checkbox-group--sm">
                                <input
                                        aria-label="Afficher le mot de passe"
                                        class="js-password-container__toggle"
                                        id="password-show"
                                        type="checkbox"
                                >
                                <label class="fr-password__checkbox fr-label" for="password-show">
                                    Afficher
                                </label>
                            </div>
                        </div>
                        <div class="fr-input-group fr-password js-password-container">
                            <label class="fr-label" for="confirm_password">Confirmez votre mot de passe</label>
                            <div class="fr-input-wrap">
                                <input
                                        class="fr-password__input fr-input js-password-container__input"
                                        required
                                        type="password"
                                        id="confirm_password"
                                        name="confirm_password"
                                        aria-label="Confirmez votre mot de passe"
                                        aria-describedby="password-confirmation-error"
                                >
                            </div>
                            <div class="fr-password__checkbox fr-checkbox-group fr-checkbox-group--sm">
                                <input
                                        aria-label="Afficher la confirmation de mot de passe"
                                        id="password-confirmation-show"
                                        class="js-password-container__toggle"
                                        type="checkbox"
                                        aria-describedby="password-confirmation-error"
                                >
                                <label class="fr-password__checkbox fr-label" for="password-confirmation-show">
                                    Afficher
                                </label>
                            </div>
                            <p class="fr-sr-only" id="password-confirmation-error"></p>
                        </div>

                        <%- include('../partials/card-button-container.ejs', {label: 'Enregistrer'}) %>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/assets/confirm-password_20230828.js"></script>
<script src="/assets/show-password.js"></script>
<script src="/assets/password-feedback_20231018.js"></script>
